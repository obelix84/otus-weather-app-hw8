(()=>{const t="";async function e(e,n){const o=`https://api.openweathermap.org/data/2.5/weather?&units=metric&lat=${e}&lon=${n}&appid=${t}`;let r;try{r=await fetch(o)}catch(t){console.error("Error fetching OWM data",t)}return r.json()}window.addEventListener("load",(function(){navigator.geolocation?navigator.geolocation.getCurrentPosition((function(n){const{longitude:c,latitude:l}=n.coords;e(l,c).then((t=>{i(t.main.temp,t.main.temp_min,t.main.temp_max,t.weather[0].icon),r()})),async function(e,n){const o=`https://api.openweathermap.org/geo/1.0/reverse?lat=${e}&lon=${n}&limit=5&appid=${t}`;let r;try{r=await fetch(o)}catch(t){console.error("Error fetching OWM data",t)}return r.json()}(l,c).then((t=>{a(t[0].name),o(t[0].name,t[0].lat,t[0].lon)}))}),(function(){console.error("Can't find coordinates")})):console.error("Geolocation isn't work")}));const n=document.getElementById("show");function o(t,e,n){const o=document.getElementById("history"),r=document.createElement("li");r.setAttribute("class","list-group-item");const a=document.createElement("a");a.href="#",a.innerText=t,a.setAttribute("data-lat",e),a.setAttribute("data-lon",n),a.onclick=c,r.append(a),o.append(r);const i=o.querySelectorAll("li.list-group-item:not(li.active)");i.length>5&&o.removeChild(i[0])}function r(t,e){document.getElementById("map"),console.log("show map")}function a(t){document.getElementById("city").innerText=t}function i(t,e,n,o){const r=document.getElementById("weather"),a=r.querySelector("p");r.removeChild(a);const i=r.querySelector("img");i&&r.removeChild(i);const c=document.createElement("img");c.src=`https://openweathermap.org/img/wn/${o}@4x.png`;const l=document.createElement("p");l.innerHTML=`Current: <b>${Math.round(t)}</b><br>`,l.innerHTML+=`Max: <b>${Math.round(n)}</b><br>`,l.innerHTML+=`Min: <b>${Math.round(e)}</b><br>`,r.append(l),r.append(c)}function c(t){console.log(t.target.getAttribute("data-lat")),e(t.target.getAttribute("data-lat"),t.target.getAttribute("data-lon")).then((e=>{r(),a(t.target.innerText),i(e.main.temp,e.main.temp_min,e.main.temp_max,e.weather[0].icon)}))}document.querySelector("#input").addEventListener("change",(function(){""!==document.querySelector("#input").value?document.querySelector('button[type="submit"]').removeAttribute("disabled"):document.querySelector('button[type="submit"]').setAttribute("disabled","")})),n.addEventListener("click",(function(){const n=document.querySelector("#input"),c=n.value;""!==c&&async function(e){const n=`https://api.openweathermap.org/geo/1.0/direct?q=${e}&limit=1&appid=${t}`;let o;try{o=await fetch(n)}catch(t){console.error("Error fetching OWM data",t)}return o.json()}(c).then((t=>{0===t.length?alert("Incorrect city name!"):(o(t[0].name,t[0].lat,t[0].lon),r(t[0].lat,t[0].lon),a(t[0].name),e(t[0].lat,t[0].lon).then((t=>{i(t.main.temp,t.main.temp_min,t.main.temp_max,t.weather[0].icon)})))})),n.value="",document.getElementById("show").setAttribute("disabled","")}))})();